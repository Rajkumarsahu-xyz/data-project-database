WITH playerWithPotmAwards AS (SELECT season, player_of_match, COUNT(*) AS numberOfPotmAwards FROM matches GROUP BY season, player_of_match), maxPotmAwards AS (SELECT season, MAX(numberOfPotmAwards) AS maxPotmAwards FROM playerWithPotmAwards GROUP BY season) SELECT pa.season, pa.player_of_match, pa.numberOfPotmAwards FROM playerWithPotmAwards pa INNER JOIN maxPotmAwards mpa ON pa.season = mpa.season AND pa.numberOfPotmAwards = mpa.maxPotmAwards ORDER BY pa.season, pa.player_of_match;
